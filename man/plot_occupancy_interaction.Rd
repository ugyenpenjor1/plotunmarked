% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_occupancy_interaction.R
\name{plot_occupancy_interaction}
\alias{plot_occupancy_interaction}
\title{Plot occupancy interaction surface from an \code{unmarked} model}
\usage{
plot_occupancy_interaction(
  model,
  cov1,
  cov2,
  grid_length = 400,
  chunk_size = 50000,
  palette = NULL,
  xlab = NULL,
  nonInt_cov = list()
)
}
\arguments{
\item{model}{A fitted \code{unmarkedFitOccu} model object created using \code{unmarked::occu()}.}

\item{cov1}{A character string indicating the first covariate involved in the interaction (x-axis).}

\item{cov2}{A character string indicating the second covariate involved in the interaction (color scale).}

\item{grid_length}{Integer. Number of points to generate along each covariate axis (default is 400).}

\item{chunk_size}{Integer. Number of rows to predict per chunk (default is 50,000).}

\item{palette}{Character. Name of the color palette to use for the gradient. Must be compatible with \code{hcl.colors()}.
Default is \code{"cividis"}. If \code{NULL}, uses \code{"cividis"} as fallback.}

\item{xlab}{Optional character string to override the x-axis label. Defaults to the name of \code{cov1}.}

\item{nonInt_cov}{Named list. Optional. Values to supply for additional site-level covariates not in the interaction. If not provided, these covariates will be filled using their median from the training data.}
}
\value{
A \code{ggplot2} plot object showing predicted occupancy across a grid of \code{cov1} and \code{cov2} values.
}
\description{
Generates an interaction surface plot of occupancy probability for two interacting site-level covariates
from a fitted \code{unmarked} occupancy model (class \code{unmarkedFitOccu}).
This function creates a prediction grid over the range of two covariates, makes predictions in chunks
to improve performance, and visualises the interaction using a color gradient.
Useful for visualising how two site-level covariates jointly affect
occupancy probability while holding other covariates constant.
}
\examples{
if (requireNamespace("unmarked", quietly = TRUE)) {
  # Simulate data
  set.seed(123)
  n_sites <- 50
  n_visits <- 3
  site_covs <- data.frame(
    elev = scale(rnorm(n_sites)),
    forest = scale(rnorm(n_sites)),
    river = scale(rnorm(n_sites))
  )
  obs_covs <- list(effort_s = matrix(rnorm(n_sites * n_visits), n_sites, n_visits))
  y <- matrix(rbinom(n_sites * n_visits, 1, 0.5), n_sites, n_visits)

  umf <- unmarked::unmarkedFrameOccu(y = y, siteCovs = site_covs, obsCovs = obs_covs)
  mod <- unmarked::occu(~ effort_s ~ river + elev * forest, data = umf)

  # Plot interaction surface
  plot <- plot_occupancy_interaction(
    model = mod,
    cov1 = "elev",
    cov2 = "forest",
    grid_length = 100,
    chunk_size = 5000,
    xlab = "elev",
    nonInt_cov = list(river = 0)
  )
  print(plot)
}

}
